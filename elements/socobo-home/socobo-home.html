<!-- Toolbar -->
<link rel="import" href="../../bower_components/core-toolbar/core-toolbar.html">
<!-- Paper Effects -->
<link rel="import" href="../../bower_components/paper-shadow/paper-shadow.html">
<!-- Google Maps -->
<link rel="import" href="../../bower_components/google-map/google-map.html">
<link rel="import" href="../../bower_components/google-map/google-map-directions.html">
<link rel="import" href="../../bower_components/google-map/google-map-search.html">
<!-- Input Fields -->
<link rel="import" href="../../bower_components/core-field/core-field.html">
<link rel="import" href="../../bower_components/core-icon/core-icon.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-input/paper-input-decorator.html">
<!--
OpenStreetMap
  https://github.com/nhnb/leaflet-map !!!
  https://github.com/prtksxna/leaflet-map-component
  https://github.com/ruben96/open-map
-->


<polymer-element name="socobo-home">

  <template>
    <style>
      :host {
        font-family: RobotoDraft, 'Helvetica Neue', Helvetica, Arial;
        margin-left: 10px;
      }

      #core_card_home {
        width: 70%;
        min-width: 320px;
        height: 210px;
        border-radius: 2px;
        margin-top: 50px;
        box-shadow: rgba(0, 0, 0, 0.0980392) 0px 2px 4px, rgba(0, 0, 0, 0.0980392) 0px 0px 3px;
        background-color: rgb(255, 255, 255);
      }

       #core_card_maps {
          width: 70%;
          min-width: 320px;
          height: 500px;
          border-radius: 2px;
          margin-top: 50px;
          margin-bottom: 20px;
          box-shadow: rgba(0, 0, 0, 0.0980392) 0px 2px 4px, rgba(0, 0, 0, 0.0980392) 0px 0px 3px;
          background-color: rgb(255, 255, 255);
        }

      core-toolbar {
        right: 0px;
        color: rgb(255, 255, 255);
        fill: rgb(255, 255, 255);
        background-color: rgb(79, 125, 201);
      }

      #sectionHeadline {
        padding: 5px;
        margin: 10px;
        opacity: 1;
        font-size: 20px;
      }

      #sectionLorem {
        padding: 5px;
        margin: 10px;
        height: 100%;
        overflow: auto;
      }

      /*Input Fields*/
      paper-input {
        color: #fff;
        width: 25%;
        max-width: 120px;
        text-align: right;
      }

      paper-input-decorator {
        width: 25%;
        max-width: 120px;
        font-size: 16px;
        text-align: right;
      }

      paper-input-decorator /deep/ .unfocused-underline {
        /* line color when the input is unfocused */
        background-color: #fff;
        text-align: right;
      }

      paper-input-decorator[focused] /deep/ .label-text {
        /* label color when the input is focused */
        color: #fff;
        text-align: right;
      }

      paper-input-decorator /deep/ .focused-underline {
        /* line color when the input is focused */
        background-color: #fff;
        text-align: right;
      }

      /*Maps*/
      #mapsContainer {
        margin: 5px;
        height: 370px;
      }

      google-map {
        display: block;
        height: 100%;
      }

      /*Button*/
      paper-button, p {
        margin: 5px;
        padding: 0px;
      }

      paper-button.colored {
        color: #4285f4;
      }

      paper-button[raised].colored {
        background: #4285f4;
        color: #fff;
      }
    </style>

    <!-- Welcome Card -->
    <core-card id="core_card_home" vertical layout shadow>
      <paper-shadow z="1">
        <core-toolbar id="core_toolbar_home" shadow>
          <div id="div" flex>Home</div>
        </core-toolbar>
      </paper-shadow>

      <br/>

      <section id="sectionHeadline">
        <h4>Welcome to Socobo</h4>
      </section>

      <br/>

      <section id="sectionLorem">
        <article>Lorem ipsum dolor sit amet, consetetur sadipscing elitr,
                 sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat,
                 sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet
                 clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.
                 Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod
                 tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua.</article>
      </section>
    </core-card>

    <!-- Map Card -->
    <core-card id="core_card_maps" vertical layout shadow>
      <paper-shadow z="1">
        <core-toolbar id="core_toolbar_maps" shadow>
          <div id="div" flex>Maps</div>
          <p id="showErrorMessage"></p>
          <paper-input-decorator label="Enter your latitude...">
            <input is="core-input"
                   id="txtLatitude"
                   type="number"
                   align="right"
                   value="{{latitude}}"
                   step="any">
          </paper-input-decorator>
          <paper-input-decorator label="Enter your longitude...">
            <input is="core-input"
                   id="txtLongitude"
                   type="number"
                   align="right"
                   value="{{longitude}}"
                   step="any">
          </paper-input-decorator>
        </core-toolbar>
      </paper-shadow>

      <div id="mapsContainer">
        <google-map map="{{map}}"
                    latitude="{{latitude}}"
                    longitude="{{longitude}}"
                    zoom="19">
          <google-map-marker id="gMarker"
                             latitude="{{latitude}}"
                             longitude="{{longitude}}"
                             title="You are here!"
                             draggable="true">
          </google-map-marker>
        </google-map>
      </div>

      <paper-button id="btnBackend"
                    on-click="{{getLocation}}"
                    raised
                    class="colored">Get Location</paper-button>
    </core-card>
  </template>

  <script>
    Polymer({

      latitude: undefined,
      longitude: undefined,
      errorMessage: undefined,
      posOptions: {
        enableHighAccuracy: true,
        timeout: 5000,
        maximumAge: 0
      },

      ready: function() {
        this.getLocation();
      },

      getLocation: function() {
        if ("geolocation" in navigator) {
          navigator.geolocation.getCurrentPosition(this.posSucces.bind(this),
                                                   this.posError.bind(this),
                                                   this.posOptions);
        } else {
          this.errorMessage.value = "Geolocation is not supported by this browser.";
          this.$.showErrorMessage.value = this.errorMessage;
        }
      },

      posSucces: function(position) {
        this.latitude = position.coords.latitude;
        this.longitude = position.coords.longitude;

        this.$.txtLatitude.value = this.latitude.toFixed(6);
        this.$.txtLongitude.value = this.longitude.toFixed(6);
      },

      posError: function(error) {
        switch(error.code) {
          case error.PERMISSION_DENIED:
            this.errorMessage.value = "User denied the request for Geolocation."
            this.$.showErrorMessage.value = this.errorMessage;
            break;
          case error.POSITION_UNAVAILABLE:
            this.errorMessage.value = "Location information is unavailable."
            this.$.showErrorMessage.value = this.errorMessage;
            break;
          case error.TIMEOUT:
            this.errorMessage.value = "The request to get user location timed out."
            this.$.showErrorMessage.value = this.errorMessage;
            break;
          case error.UNKNOWN_ERROR:
            this.errorMessage.value = "An unknown error occurred."
            this.$.showErrorMessage.value = this.errorMessage;
            break;
        }
      }
    });
  </script>
</polymer-element>